FORMAT EXACT POUR TEXT-TO-SPEECH - SUIT CETTE STRUCTURE:
from groq import Groq
import os
import uuid
from pathlib import Path

# SUPPORTED VOICES FOR GROQ PLAYAI TTS:
# Aaliyah-PlayAI, Adelaide-PlayAI, Angelo-PlayAI, Arista-PlayAI, Atlas-PlayAI,
# Basil-PlayAI, Briggs-PlayAI, Calum-PlayAI, Celeste-PlayAI, Cheyenne-PlayAI,
# Chip-PlayAI, Cillian-PlayAI, Deedee-PlayAI, Eleanor-PlayAI, Fritz-PlayAI,
# Gail-PlayAI, Indigo-PlayAI, Jennifer-PlayAI, Judy-PlayAI, Mamaw-PlayAI,
# Mason-PlayAI, Mikail-PlayAI, Mitch-PlayAI, Nia-PlayAI, Quinn-PlayAI,
# Ruby-PlayAI, Thunder-PlayAI

SUPPORTED_VOICES = [
    "Aaliyah-PlayAI", "Adelaide-PlayAI", "Angelo-PlayAI", "Arista-PlayAI", "Atlas-PlayAI",
    "Basil-PlayAI", "Briggs-PlayAI", "Calum-PlayAI", "Celeste-PlayAI", "Cheyenne-PlayAI",
    "Chip-PlayAI", "Cillian-PlayAI", "Deedee-PlayAI", "Eleanor-PlayAI", "Fritz-PlayAI",
    "Gail-PlayAI", "Indigo-PlayAI", "Jennifer-PlayAI", "Judy-PlayAI", "Mamaw-PlayAI",
    "Mason-PlayAI", "Mikail-PlayAI", "Mitch-PlayAI", "Nia-PlayAI", "Quinn-PlayAI",
    "Ruby-PlayAI", "Thunder-PlayAI"
]

def generate_speech(text: str, voice: str = "Aaliyah-PlayAI", speed: float = 1.0, output_format: str = "mp3", output_dir: str = ".") -> dict:
    """
    Generate an audio file from text using PlayAI TTS.
    Args:
        text: Text to convert to speech (str)
        voice: Voice name to use (str) - MUST be one of SUPPORTED_VOICES (e.g., "Aaliyah-PlayAI", "Fritz-PlayAI")
        speed: Speech speed (0.25 to 4.0, default 1.0)
        output_format: Output audio format ('mp3', 'opus', 'aac', 'flac', 'wav')
        output_dir: Directory where the audio file will be saved (default: current directory)
    Returns:
        dict with keys:
            - audio_file_path: Absolute path to the saved audio file
            - format: Audio file format
            - text_length: Number of characters in text
            - voice_used: Voice used
    """
    # Step 1: Validate input
    if not isinstance(text, str) or len(text) == 0:
        raise ValueError("text must be non-empty string")
    if voice not in SUPPORTED_VOICES:
        raise ValueError(f"voice must be one of: {SUPPORTED_VOICES}")
    if not 0.25 <= speed <= 4.0:
        raise ValueError("speed must be between 0.25 and 4.0")
    if output_format not in ("mp3", "opus", "aac", "flac", "wav"):
        raise ValueError("output_format must be one of: mp3, opus, aac, flac, wav")

    # Step 2: Get API key
    api_key = os.getenv("GROQ_API_KEY")
    if not api_key:
        raise ValueError("GROQ_API_KEY not set")

    # Step 3: Create Groq client
    client = Groq(api_key=api_key)

    # Step 4: Generate speech
    response = client.audio.speech.create(
        model="playai-tts",
        input=text,
        voice=voice,
        speed=speed,
        response_format=output_format
    )

    # Step 5: Save audio to file using write_to_file (RECOMMENDED METHOD)
    output_dir_path = Path(output_dir).resolve()
    audio_file_path = str(output_dir_path / f"speech_{uuid.uuid4().hex}.{output_format}")
    response.write_to_file(audio_file_path)

    # Step 6: Return structured result
    return {
        "audio_file_path": audio_file_path,
        "format": output_format,
        "text_length": len(text),
        "voice_used": voice
    }

# RÈGLES CRITIQUES TEXT-TO-SPEECH:
# - Utiliser client.audio.speech.create()
# - Model DOIT être "playai-tts"
# - Voice DOIT être une des voix supportées: Aaliyah-PlayAI, Fritz-PlayAI, etc. (voir SUPPORTED_VOICES)
# - NE JAMAIS utiliser "alloy" comme voix - ce n'est PAS supporté par Groq PlayAI TTS
# - Valider la vitesse (0.25-4.0)
# - TOUJOURS utiliser response.write_to_file(audio_file_path) pour sauvegarder l'audio
# - Générer un nom de fichier unique avec uuid.uuid4().hex
# - Retourner le chemin absolu du fichier audio (audio_file_path)
# - Supporter les formats: mp3, opus, aac, flac, wav
# - Importer uuid et Path depuis pathlib



example of use groq

import os
import uuid
from pathlib import Path
from groq import Groq

client = Groq(api_key=os.environ.get("GROQ_API_KEY"))

model = "playai-tts"
voice = "Fritz-PlayAI"  # MUST use a PlayAI voice like Fritz-PlayAI, Aaliyah-PlayAI, etc.
text = "I love building and shipping new features for our users!"
response_format = "wav"

response = client.audio.speech.create(
    model=model,
    voice=voice,
    input=text,
    response_format=response_format
)

# RECOMMENDED: Save audio using write_to_file with unique filename
output_dir_path = Path.cwd()
audio_file_path = str(output_dir_path / f"speech_{uuid.uuid4().hex}.{response_format}")
response.write_to_file(audio_file_path)